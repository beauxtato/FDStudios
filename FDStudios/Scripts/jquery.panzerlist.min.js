/* Panzer HTML5 Audio Playlist 1.0 */
(function(a){function e(b){!a.browser.msie||document.documentMode>=9||event.button||(d=!1),1!==b.which||d||(b.which=0)}function f(b,c){var d=b.offset(),e=c.pageX-d.left,f=100*e/(b.width()+1);0>f&&(f=0),f>100&&(f=100),$elems=b.parents(".panzerlist").find(".list a"),$elems.each(function(){data=a(this).data("panzerlist"),data.audio.volume=f/100})}var b=navigator.userAgent.toLowerCase(),c=b.match(/(iphone|ipod|ipad)/),d=!1,g={init:function(b){function j(){data=a(this).data("panzerlist"),a(".play",data.player).toggleClass("play pause")}function k(){data=a(this).data("panzerlist"),a(".pause",data.$player).toggleClass("play pause")}function l(){if(data=a(this).data("panzerlist"),data.audio.pause(),data.player.hasClass("auto-advance")){if($active=data.player.find(".list a.active"),$active.is(":last-child")){if(!data.player.hasClass("repeat-all"))return;$next=data.player.find(".list a:first")}else $next=$active.next("a");$next.trigger("click")}}function m(){data=a(this).data("panzerlist");var b=100*data.audio.currentTime/data.audio.duration;if(!isNaN(b)){var c,d,e;c=Math.floor(data.audio.currentTime/60),d=isNaN(c)?"00":c>=10?c:"0"+c,e=Math.floor(data.audio.currentTime%60),e=isNaN(e)?"00":e>=10?e:"0"+e,!isNaN(c)&&c>99&&a("span.duration",data.player).addClass("small"),a("span.duration",data.player).html(d+":"+e),0==b?a(".elapsed",data.player).hide().css("width",0):a(".elapsed",data.player).show().css("width",b+"%")}}function n(){data=a(this).data("panzerlist");var b=100*data.audio.volume;0==b?a(".volume .set",data.player).hide().css("width",0):a(".volume .set",data.player).show().css("width",b+"%")}function o(b){if(b.preventDefault(),$this=a(this),a(".panzerlist.pause-others .list a.active").not($this).each(function(){var b=a(this).data("panzerlist");b&&(b.audio.paused||b.audio.pause())}),data=a(this).parents(".panzerlist").find(".list a.active").data("panzerlist"),$isactive=a(this).hasClass("active"),data.audio.paused||($isactive||data.audio.pause(),data.audio.currentTime=0),$isactive)data.audio.play();else{try{data.audio.currentTime=0}catch(c){}data=a(this).data("panzerlist"),a(this).parents(".panzerlist").find(".list a").removeClass("active"),a(this).addClass("active"),data.audio.play()}}var g=a.extend({layout:"big",theme:"custom",expanded:!0,title:"",cover:"",volume:100,show_prev_next:!1,show_list:!0,pause_others:!0,auto_start:!1,auto_advance:!0,repeat_all:!1,outdated_text:"Your browser is outdated, but you can still download and listen to the audio files on your computer.",auto_numbering:!0},b);0>g.volume&&(g.volume=0),g.volume>100&&(g.volume=100);var h="";"big"==g.layout&&(h=" panzerlist-big"),h+=" panzerlist-"+g.theme,g.expanded&&(h+=" panzerlist-expand"),g.show_prev_next||(h+=" hide-prev-next"),g.show_list||(h+=" hide-list"),g.pause_others&&(h+=" pause-others"),g.auto_advance&&(h+=" auto-advance"),g.repeat_all&&(h+=" repeat-all");var i=document.createElement("audio");return i.canPlayType?(controls='<div class="controls"><span class="play"><em></em></span><div class="prev-next"><span class="prev"></span><span class="next"></span></div></div><div class="progress-wrapper"><div class="progress"><div class="elapsed" style="width:0;display:none"></div></div></div><span class="duration">00:00</span><div class="volume-wrapper"><span></span><div class="volume"><div class="set" style="width:'+g.volume+'%"></div></div></div>',song_title=g.title&&0!==g.title.length?'<div class="title">'+g.title+"</div>":"",""!=g.cover?(album_cover='<div class="cover"><img src="'+g.cover+'" alt="" /></div>',g.show_list&&(h+=" hide-list")):album_cover="",$player=a('<div class="panzerlist'+h+'">'+song_title+album_cover+'<div class="list"></div><div class="player">'+controls+"</div></div>"),a(".play",$player).click(function(){a(this).hasClass("play")&&(a(".panzerlist.pause-others").each(function(){var b=a(this).find("a.active").data("panzerlist");b&&!b.audio.paused&&b.audio.pause()}),a(".panzer.pause-others").each(function(){var b=a(this).data("panzer");b&&!b.audio.paused&&b.audio.pause()})),data=a(this).parents(".panzerlist").find(".list a.active").data("panzerlist"),data.audio.paused?data.audio.play():data.audio.pause()}),a(".prev,.next",$player).click(function(){if($active=a(this).parents(".panzerlist").find(".list a.active"),data=$active.data("panzerlist"),a(this).hasClass("prev"))if($active.is(":first-child")){if(!data.player.hasClass("repeat-all"))return;$next=data.player.find(".list a:last")}else $next=$active.prev("a");else if($active.is(":last-child")){if(!data.player.hasClass("repeat-all"))return;$next=data.player.find(".list a:first")}else $next=$active.next("a");data.audio.pause(),data.audio.currentTime=0,$next.trigger("click")}),a(".volume",$player).mousedown(function(b){1===b.which&&(d=!0,f(a(this),b))}).mouseup(function(a){1===a.which&&(d=!1)}).mousemove(function(b){e(b),1==b.which&&0==b.button&&f(a(this),b)}),a(".progress",$player).click(function(b){var c=a(this).offset(),d=b.pageX-c.left,e=100*d/(a(this).width()+1);0>e&&(e=0),e>100&&(e=100),$audio_el=a(this).parents(".panzerlist").find(".list a.active"),data=$audio_el.data("panzerlist");var f=Math.round(data.audio.duration/100*e);0===data.audio.readyState?data.audio.addEventListener("canplay",function(){data=a(this).data("panzerlist"),data.audio.currentTime=f}):data.audio.currentTime=f}),$i=0,this.each(function(){var b=a(this),d=b.get(0);b.is("audio")&&(b.data("panzerlist")||(d.volume=g.volume/100,d.addEventListener("play",j),d.addEventListener("pause",k),d.addEventListener("ended",l),d.addEventListener("timeupdate",m),d.addEventListener("volumechange",n),$i++,$el=a('<a href="'+b.children("source:first").attr("src")+'"'+(1==$i?' class="active"':"")+">"+(g.auto_numbering?$i+". ":"")+b.attr("title")+"</a>").data("panzerlist",{audio:d,player:$player}).click(o),a(".list",$player).append($el),b.after($player).data("panzerlist",{audio:d,player:$player,elem:$el,loc:b.prev()}),c?b.css({position:"absolute",top:-9999,width:0,height:0,display:"none",visibility:"hidden",overflow:"hidden"}):b.detach()))}),g.auto_start&&a(".list a:first",$player).trigger("click")):(h=" panzerlist-unsupported","big"==g.layout&&(h+=" panzerlist-big"),h+=" panzerlist-"+g.theme,g.expanded&&(h+=" panzerlist-expand"),song_title=g.title&&0!==g.title.length?'<div class="title">'+g.title+"</div>":"",""!=g.cover?(album_cover='<div class="cover"><img src="'+g.cover+'" alt="" /></div>',g.show_list&&(h+=" hide-list")):album_cover="",$player=a('<div class="panzerlist'+h+'">'+song_title+album_cover+'<div class="list"></div><div class="player"><strong class="alert">'+g.outdated_text+"</strong></div></div>"),$i=0,this.each(function(){var b=a(this);b.is("audio")&&(b.data("panzerlist")||($i++,$el=a('<a href="'+b.children("source:first").attr("src")+'"'+">"+$i+". "+b.attr("title")+"</a>").data("panzerlist",{player:$player}),a(".list",$player).append($el),b.after($player).data("panzerlist",{player:$player,elem:$el,loc:b.prev()}).detach()))})),this},destroy:function(){return this.each(function(){var b=a(this),d=b.data("panzerlist");d&&(c?b.removeAttr("style"):d.loc&&d.loc.after(b),d.player.remove(),b.removeData("panzerlist").removeAttr("style"),d=null)})}};a.fn.panzerlist=function(b){return g[b]?g[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist on jQuery.panzerlist"),void 0):g.init.apply(this,arguments)}})(jQuery);